function chart(c){Chart.defaults.global.defaultFontFamily="vazir";var a=document.getElementById("chart");var b=new Chart(a,{type:"bar",data:{labels:["امتیاز"],datasets:[{label:"جمع امتیازات کاربران در بازه ی انتخاب شده",data:[c],backgroundColor:["rgba(75, 192, 192, 0.2)"],hoverBackgroundColor:["rgba(75, 192, 192, 0.4)"],borderColor:["rgba(0, 0, 0, 1)"],borderWidth:2}]},options:{barThickness:32,scales:{yAxes:[{ticks:{beginAtZero:true}}]}}})}$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()});$(document).ready(function(){$("#user_found").hide();$("#searchBtn").click(function(){var a=$("#searchInput").val();$.ajax({url:"/admin/searchUser",method:"POST",dataType:"json",data:{keyword:a},success:function(b){if(b!=null){$("#not_found").hide();$("#user_found tbody").html("<tr><th>1</th><td>"+b.fullname+"</td><td>"+b.personal_id+'</td><td>2500</td><td><div class="btn-group"><button class="btn btn-sm btn-success" id="tableBtnInfo" data-toggle="tooltip" data-placement="bottom" title="افزودن امتیاز"><a href="#" class="text-white" id="btnScore"><i class="fa fa-plus"></i></a></button><button class="btn btn-sm btn-info" id="tableBtnInfo" data-toggle="tooltip" data-placement="bottom" title="مشاهده اطلاعات"><a href="#" class="text-white" id="btnStatus"><i class="fa fa-eye"></i></a></button></div></td></tr>');$("#btnScore").attr("href","/admin/showaddScore/"+b.personal_id+"&"+b.user_id);$("#btnStatus").attr("href","/admin/status/"+b.personal_id);$("#user_found").show()}else{$("#user_found").hide();$("#not_found").show()}}})})});$("#user_detail").ready(function(){var a;$("#progress, #table").hide();$.ajax({url:"/admin/getDetail",method:"POST",dataType:"json",success:function(e){if(e!=null){var d=JSON.parse(e.details);sum=parseInt(e.sum);extra=parseInt(e.extra);var b=sum+extra;var c=100-b;$("#goodResult").css({width:b+"%"});$("#badResult").css({width:c+"%"});$("#goodResult").text(b+"% عملکرد خوب");$("#badResult").text(c+"% عملکرد ضعیف");for(a=1;a<=10;a++){$("#score_"+a).text(d["score_"+a]);$("#text_"+a).text(d["text_"+a])}$("#progress, #table").show()}}})});$("#changeaccess").ready(function(){$("#change-access-btn").click(function(){var a=window.location.pathname.substr(14,19);var c=$("#accesslevel option:selected").text();var d=$("#currentacess").val();if($("#accesslevel option:selected").val()!=0){if(c!=d){$("#change-access-msg").hide();var b=$("#accesslevel option:selected").val();$.ajax({url:"/admin/accessLevel",method:"POST",dataType:"json",data:{newAccess:b,personalId:a},success:function(e){}});$.ajax({url:"/admin/getAccess",method:"POST",dataType:"json",data:{personalId:a},success:function(h){if(h.access==="|user|"){$("#currentacess").val("کاربر")}else{if(h.access==="|admin|"){$("#currentacess").val("مدیر")}}var f=$("#currentacess"),e=2000,g=f.css("color");f.css({color:"red","font-weight":"900"});setTimeout(function(){f.css({color:g,"font-weight":"400"})},e);$("#accesslevel").val(0)}})}else{$("#change-access-msg").text("سطح دسترسی انتخاب شده با سطح دسترسی فعلی برابر است و امکان تغییر وجود ندارد!").css({color:"red","font-weight":"900"})}}})});$("#change-user-pass").ready(function(){$("#change-pass-btn").click(function(){var a=window.location.pathname.substr(14,19);var b=$("#change-pass").val();var c=$("#change-passconf").val();if(b===c){$.ajax({url:"/admin/changeUserPass",method:"POST",dataType:"json",data:{passConf:c,personalId:a},success:function(g){if(g==true){var e=$("#change-pass-msg"),d=2500,f=e.css("color");e.css({color:"green","font-weight":"900"});e.text("پسورد کاربر با موفقیت تغییر یافت.").show();setTimeout(function(){e.css({color:f,"font-weight":"400"}).hide()},d)}else{var e=$("#change-pass-msg"),d=3000,f=e.css("color");e.css({color:"red","font-weight":"900"});e.text("رمزعبور تغییر نیافت! فرایند تغییر رمز دچار مشکل شده است.").show();setTimeout(function(){e.css({color:f,"font-weight":"400"}).hide()},d)}}})}else{$("#change-pass-msg").text("پسوردهای وارد شده یکسان نیستند! لطفا مجددا تلاش کنید.").css({color:"red","font-weight":"900"});$("#change-pass").focus()}})});$(document).ready(function(){$("#listproblem").hide();$("#usersList").click(function(){$(this).parent().hide();$.ajax({url:"/admin/showAllUsers",method:"POST",dataType:"json",success:function(h){if(h!=null){var d;var a;var g;var b;var c;var f="/admin/status/";for(d=0;d<=h.length;d++){b=h[d]["personal_id"];c=h[d]["user_id"];if(h[d]["access"]=="|user|"){a="کاربر"}else{if(h[d]["access"]=="|admin|"){a="مدیر"}else{if(h[d]["access"]=="|superadmin|"){a="مدیرکل"}}}if(h[d]["total"]==null){g="ندارد"}else{g=h[d]["total"]}var e=f+b;$("#list_found tbody").append('<tr class="lead"><td>'+[d+1]+"</td><td>"+h[d]["fullname"]+"</td><td>"+b+"</td><td>"+g+"</td><td>"+a+'</td><td><div class="btn-group"><button class="btn btn-sm btn-info"><a class="text-white text-decoration-none" href=""><i class="fas fa-eye"></i></a></button></div></td></tr>')}}else{$("#listproblem").css({"font-weight":"900"});$("#listproblem").show()}}})})});$(document).ready(function(){$("#report-button").click(function(){var c=$("#from-date").val();var b=$("#to-date").val();var a=$("#report-access").val();c=c.split("/").join("-");b=b.split("/").join("-");a=a.split("|").join("");$.ajax({url:"/user/getReport",method:"post",dataType:"json",data:{fromDate:c,toDate:b,access:a},success:function(e){if(e.length>0){$("#result tbody").empty();var d;for(d=0;d<=e.length;d++){$("#result tbody").append('<tr class="lead"><td>'+[d+1]+"</td><td>"+e[d]["date"]+"</td><td>"+e[d]["sum"]+"</td></tr>")}}else{new Noty({text:"در بازه ی انتخاب شده گزارشی وجود ندارد.",type:"info",theme:"bootstrap-v4",timeout:4000,progressBar:true}).show()}}})})});$(document).ready(function(){$("#report-admin-button").click(function(){var b=$("#from-date").val();var a=$("#to-date").val();b=b.split("/").join("-");a=a.split("/").join("-");$.ajax({url:"/admin/adminReport",method:"post",dataType:"json",data:{fromDate:b,toDate:a},success:function(d){const c=d[0]["total"];if(c!=null){chart(c)}else{new Noty({text:"در بازه ی انتخاب شده گزارشی وجود ندارد.",type:"info",theme:"bootstrap-v4",timeout:4000,progressBar:true}).show()}}})})});$(document).ready(function(){$("#sidebar").on("shown.bs.collapse",function(a){if(a.target===this){$("html,body").animate({scrollTop:$("#toOfPage").offset().top},1500)}})});$(document).ready(function(){from=$("#datepicker #from-date").pDatepicker({responsive:true,altField:"#from-date",altFormat:"YYYY/MM/DD",observer:true,format:"YYYY/MM/DD",initialValue:false,initialValueType:"persian",autoClose:true,maxDate:"today",timePicker:{enabled:false},dayPicker:{enabled:true},yearPicker:{enabled:true},calendar:{persian:{enabled:true,locale:"fa",leapYearMode:"algorithmic"}},navigator:{scroll:{enabled:true},text:{btnNextText:"بعدی",btnPrevText:"قبلی"}},toolbox:{calendarSwitch:{enabled:false}},onSelect:function(a){from.touched=true;if(to&&to.options&&to.options.minDate!=a){var b=to.getState().selected.unixDate;to.options={minDate:a};if(to.touched){to.setDate(b)}}}});to=$("#datepicker #to-date").pDatepicker({responsive:true,altField:"#to-date",altFormat:"YYYY/MM/DD",observer:true,format:"YYYY/MM/DD",initialValue:false,initialValueType:"persian",autoClose:true,maxDate:"today",timePicker:{enabled:false},dayPicker:{enabled:true},yearPicker:{enabled:true},calendar:{persian:{enabled:true,locale:"fa",leapYearMode:"algorithmic"}},navigator:{scroll:{enabled:true},text:{btnNextText:"بعدی",btnPrevText:"قبلی"}},toolbox:{calendarSwitch:{enabled:false}},onSelect:function(a){to.touched=true;if(from&&from.options&&from.options.maxDate!=a){var b=from.getState().selected.unixDate;from.options={maxDate:a};if(from.touched){from.setDate(b)}}}})});$(document).ready(function(){$("#searchBar").keyup(function(a){if(a.keyCode==13){$("#searchBtn").click()}})});